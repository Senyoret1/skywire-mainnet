<div *ngIf="loading" class="flex-column full-height full-width">
  <div>
    <app-tab-bar
      [titleParts]="['start.title']"
      [tabsData]="tabsData"
      [selectedTabIndex]="0"
      [showUpdateButton]="false"
    ></app-tab-bar>
  </div>
  <app-loading-indicator class="full-height"></app-loading-indicator>
</div>

<div *ngIf="!loading" class="row">
  <div class="col-12">
    <app-tab-bar
      [titleParts]="['start.title']"
      [tabsData]="tabsData"
      [selectedTabIndex]="0"
      [secondsSinceLastUpdate]="secondsSinceLastUpdate" 
      [showLoading]="updating"
      [showAlert]="errorsUpdating"
      [refeshRate]="storageService.getRefreshTime()"
      (refreshRequested)="refresh(0)"
    ></app-tab-bar>
  </div>
  <div class="col-12">
    <div class="node-list-container mt-4.5">
      <table
        class="table-white container-elevated-white"
        mat-table
        [dataSource]="dataSource"
        *ngIf="dataSource.data.length > 0"
      >
        <ng-container matColumnDef="enabled">
          <th mat-header-cell *matHeaderCellDef class="bold"></th>
          <td mat-cell *matCellDef="let node;">
            <span [class]="nodeStatusClass(node)" [matTooltip]="nodeStatusTooltip(node) | translate"></span>
          </td>
        </ng-container>

        <ng-container matColumnDef="label">
          <th mat-header-cell *matHeaderCellDef class="bold sortable-column" (click)="changeSortingOrder(sortableColumns.Label)">
            {{ 'nodes.label' | translate }}
            <mat-icon *ngIf="sortBy === sortableColumns.Label" [inline]="true">{{ sortingArrow }}</mat-icon>
          </th>
          <td id="nodeLabel" mat-cell *matCellDef="let node;">
            {{ node.label }}
          </td>
        </ng-container>

        <ng-container matColumnDef="key">
          <th mat-header-cell *matHeaderCellDef class="bold sortable-column" (click)="changeSortingOrder(sortableColumns.Key)">
            {{ 'common.key' | translate }}
            <mat-icon *ngIf="sortBy === sortableColumns.Key" [inline]="true">{{ sortingArrow }}</mat-icon>
          </th>
          <td class="node-key" mat-cell *matCellDef="let node;">
            <app-truncated-text [short]="false" [text]="node.local_pk" class="d-none d-md-block"></app-truncated-text>
            <app-truncated-text [short]="true" [text]="node.local_pk" class="d-md-none nowrap"></app-truncated-text>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let node;" (click)="$event.stopPropagation()" class="actions">
            <button (click)="showEditLabelDialog(node)" mat-icon-button [matTooltip]="'edit-label.title' | translate">
              <mat-icon>short_text</mat-icon>
            </button>
            <button
              *ngIf="node.online"
              (click)="open(node)"
              mat-icon-button
              [matTooltip]="'nodes.view-node' | translate"
            >
              <mat-icon>chevron_right</mat-icon>
            </button>
            <button
              *ngIf="!node.online"
              (click)="deleteNode(node)"
              mat-icon-button
              [matTooltip]="'nodes.delete-node' | translate"
            >
              <mat-icon>close</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let node; columns: displayedColumns;" (click)="open(node)" class="cursor-pointer"></tr>
      </table>

      <div class="nodes-empty table-white container-elevated-white" *ngIf="dataSource.data.length === 0">
        <i class="material-icons">warning</i>
        {{ 'nodes.empty' | translate }}
      </div>
    </div>
  </div>
</div>

<!--<app-toolbar>-->
<!--<app-button (action)="refresh()" icon="refresh" #refreshButton>{{ 'nodes.refresh' | translate }}</app-button>-->
<!--</app-toolbar>-->
<!--<div class="container-fluid mt-5">-->
<!--<div class="row">-->
  <!--<div class="col-md-1"></div>-->
  <!--<div class="col-md-10">-->
    <!--<div class="node-list-container">-->
      <!--<table-->
        <!--class="table-white container-elevated-white"-->
        <!--mat-table-->
        <!--[dataSource]="dataSource"-->
        <!--*ngIf="dataSource.data.length > 0"-->
      <!--&gt;-->
        <!--<ng-container matColumnDef="enabled">-->
          <!--<th mat-header-cell *matHeaderCellDef class="bold"></th>-->
          <!--<td mat-cell *matCellDef="let node;">-->
            <!--&lt;!&ndash;<span [class]="nodeStatusClass(node)" [matTooltip]="'node.statuses.' + node.status + '-tooltip' | translate"></span>&ndash;&gt;-->
            <!--<span class="dot-green"></span>-->
          <!--</td>-->
        <!--</ng-container>-->

        <!--<ng-container matColumnDef="index">-->
          <!--<th mat-header-cell *matHeaderCellDef class="bold">#</th>-->
          <!--<td id="nodeIndex" mat-cell *matCellDef="let node;let i=index;" class="bold">{{i+1}}</td>-->
        <!--</ng-container>-->

        <!--<ng-container matColumnDef="label">-->
          <!--<th mat-header-cell *matHeaderCellDef class="bold">{{ 'common.ip' | translate }}</th>-->
          <!--<td id="nodeLabel" mat-cell *matCellDef="let node;">-->
            <!--192.168.0.2-->
          <!--</td>-->
        <!--</ng-container>-->

        <!--<ng-container matColumnDef="key">-->
          <!--<th mat-header-cell *matHeaderCellDef class="bold">{{ 'common.key' | translate }}</th>-->
          <!--<td class="node-key" mat-cell *matCellDef="let node;">-->
            <!--<div class="cover"></div>-->
            <!--<app-copy-to-clipboard-text [text]="node.local_pk"></app-copy-to-clipboard-text>-->
          <!--</td>-->
        <!--</ng-container>-->

        <!--<ng-container matColumnDef="actions">-->
          <!--<th mat-header-cell *matHeaderCellDef></th>-->
          <!--<td mat-cell *matCellDef="let node;" (click)="$event.stopPropagation()" class="actions">-->
            <!--<button-->
              <!--(click)="open(node)"-->
              <!--mat-icon-button-->
              <!--[matTooltip]="'nodes.view-node' | translate"-->
            <!--&gt;-->
              <!--<mat-icon>chevron_right</mat-icon>-->
            <!--</button>-->
          <!--</td>-->
        <!--</ng-container>-->

        <!--<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>-->
        <!--<tr mat-row *matRowDef="let node; columns: displayedColumns;" (click)="open(node)" class="cursor-pointer"></tr>-->
      <!--</table>-->

      <!--<div class="nodes-empty table-white container-elevated-white" *ngIf="dataSource.data.length === 0">-->
        <!--<i class="material-icons">warning</i>-->
        <!--{{ 'nodes.empty' | translate }}-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->
  <!--<div class="col-md-1"></div>-->
<!--</div>-->
